<p>
  <%= f.label :code %>
  <%= f.text_field :code, maxlength: 4 %>
</p>

<p>
  <%= f.label :name %>
  <%= f.text_field :name %>
</p>

<p>
  <%- project_types = [["",""]]; [CruiseControlProject,JenkinsProject,TeamCityRestProject,TeamCityProject,TeamCityChainedProject,TravisProject].each do |type_class| %>
    <%- project_types << [type_class.name.titleize, type_class.name, {"data-feed-url-fields"=>type_class.feed_url_fields.join(",")}] %>
    <%- end %>
  <%= f.label :type, "Project Type" %>
  <%= f.select :type, project_types %>
</p>

<div id="field_container">
  <%- if f.object.persisted? %>
    <%- f.object.class.feed_url_fields.each do |part| %>
      <p>
      <%= f.label part.to_sym, part %>
      <%= text_field_tag "feed_url[#{part}]", f.object.serialized_feed_url_parts[part.to_s] %>
      </p>
    <%- end %>
  <%- end %>
</div>

<p>
  <%= f.label :auth_username, "Feed Username" %>
  <%= f.text_field :auth_username, :size=>40 %>
  <em>Basic or digest authentication</em>
</p>

<p>
  <%= f.label :auth_password, "Feed Password" %>
  <%= f.password_field :auth_password, size: 40, value: f.object.auth_password %>
  <em>Basic or digest authentication</em>
</p>

<p>
  <%= f.label :enabled, "Enabled?" %>
  <%= f.check_box :enabled %>
</p>

<p>
  <%= f.label :location, "Location" %>
  <%= f.text_field :location, :size=>20, :maxlength=>20 %>
</p>

<p>
  <%= f.label :aggregate_project_id, "Aggregate Project" %>
  <%= collection_select(:project, :aggregate_project_id, AggregateProject.all, :id, :name, {:prompt => false, :disabled => lambda { |ap| !ap.enabled? }, :include_blank => true}) %>
</p>

<p>
  <%= f.label :aggregate_project_id, "Tags" %>
  <%= f.text_field :tag_list, :size=>40 %>
  <em>
    Separate with commas
  </em>
</p>

<p>
  <%= f.label :polling_interval, "Polling Interval" %>
  <%= f.text_field :polling_interval, :size=>3 %> seconds
  <em>
    If blank, will use <%= Project::DEFAULT_POLLING_INTERVAL %> seconds.
    <br/>
    <% if @project.next_poll_at %>
        Will poll in <span id='time_left'><%= @project.next_poll_at > Time.now ? "#{@project.next_poll_at.utc.to_i - Time.now.utc.to_i} seconds" : "ASAP"%></span>
    <% end %>
  </em>
</p>

<hr/>

<h3>Tracker Setup</h3>

<p>
  <%= f.label :tracker_project_id, "Tracker project id" %>
  <%= f.text_field :tracker_project_id %>
</p>
<p>
  <%= f.label :tracker_auth_token, "Tracker auth token" %>
  <%= f.text_field :tracker_auth_token %>
</p>

<em>Server time is <%= Clock.now %></em>

<p style="text-align: right; margin-bottom: 0;">
  <%= submit_tag @project.new_record? ? "Create" : "Update" %>
</p>
